apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: kube-request-access-webhook
webhooks:
- name: kube-request-access.default.svc
  rules:
  - apiGroups:   [""]
    apiVersions: ["v1"]
    resources:   ["pods/exec"]
    operations: ["*"]
    scope:       "Namespaced"
  - apiGroups: ["spreadgroup.com"]
    apiVersions: ["v1"]
    resources: ["accessrequests", "accessgrants"]
    operations: ["CREATE"]
    scope: Namespaced
  clientConfig:
    service:
      namespace: default
      name: kube-request-access
    # caBundle is set by `make local-config`, DO NOT change it manually.  (this contains the base64 encoded localhost cert)
    caBundle: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURtakNDQW9LZ0F3SUJBZ0lVQTRsOXBlb0UvVElsQUI1U3MySXlRV05ZSnZBd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0tqRW9NQ1lHQTFVRUF3d2ZhM1ZpWlMxeVpYRjFaWE4wTFdGalkyVnpjeTVrWldaaGRXeDBMbk4yWXpBZQpGdzB5TWpFeU1ESXhOalF5TURoYUZ3MHlNekF4TURFeE5qUXlNRGhhTUNveEtEQW1CZ05WQkFNTUgydDFZbVV0CmNtVnhkV1Z6ZEMxaFkyTmxjM011WkdWbVlYVnNkQzV6ZG1Nd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUIKRHdBd2dnRUtBb0lCQVFDVjR3UHA4VlJ4aUhEcE15cjRIUTVGNkNVazJJc2M0aTlPT0daM21YOERpdVlhNlFQTQp4NTlCdlo0OE5sUjhSMFgvcU51S2pxSVVURTJlR0t3TDFINWZSNG5CYnRlN1BVdU9hd3Q0OHc5VUtIQUk5aEE5ClVjWVFUUTR5NGRNR0d1V2lYdlF6cGpCREhzbjVQZkdHQ2ZRaDRTQlFibmZPVk1vOVFSaUhBczNvb1RrNUpobEcKMXR6L1hYMkYrV3RzcjYxbzVES0d5S0VQa3ExS2p3Zlkvc21DMEhqMXQ3d20zV0ZtbHVUWnRYVE0wNlZrU3dNSQp4STRaYXcycldHa2s3enVkd3Z6U1RtRzhKbnBIM3JRUloyVlcvZWpORERUMS9BTXRUSEg4akZtVkZXaUI3eElQCk9GYXNqMk5rT2RQMUN1YVJBeEp1SUVQa3FhZytjSVRLblI1OUFnTUJBQUdqZ2Jjd2diUXdjUVlEVlIwUkJHb3cKYUlJZmEzVmlaUzF5WlhGMVpYTjBMV0ZqWTJWemN5NWtaV1poZFd4MExuTjJZNEliZDJWaWFHOXZheTFoZFdScApkR1Z5TG1SbFptRjFiSFF1YzNaamdoMTNaV0pvYjI5ckxYWmhiR2xrWVhSdmNpNWtaV1poZFd4MExuTjJZNElKCmJHOWpZV3hvYjNOME1Bc0dBMVVkRHdRRUF3SUhnREFUQmdOVkhTVUVEREFLQmdnckJnRUZCUWNEQVRBZEJnTlYKSFE0RUZnUVU1NmJRQmp1OWxrTTlQSmgrN01HRit6NE1xbEl3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUpRVApwQ09IODI2TWhYMHVYdVAzbGRDRXR0Smt1aDBxdTlwM0FkZ3hrYUo4aG83SmxjVnl1TlhyRlVkQWl0ZlJoNzh1CjZ2RGtjNjVhVjl4Ym96NXFoWEo0Q1FqMmFNeHpERWRLbi9wQUQzN1FmTXdEZ1Qzc2R1UmpFS2l2NEdYM2hWZ28KcWRvcVhaWERwVmRvSjlZMHZSeURvSHorMHY4dDcrR2JnVlFIckovTnVtOVhOTUFxaE1oMGQ0VkhLN2h0UmtXMgpEWmp4Znltc3M1eXZYcUNkbnNHeFFBdWg4QUFScG5oTlJnU1NSOFpndGk2RHhTL3NzNitXZEFyMEVnREN5b05TClJWR1I2VHR4bWllVlhDYkVoQjJiVjZsNm9IcDZZbVpOYTNZQkU3ZDhnZElUMkROWjZlaEp4NWU0NUhQeFhJWjAKaWpCOFpuZ0Y1d2hPQXF0UjJ3ST0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="  # CA_BUNDLE
  admissionReviewVersions: ["v1"]
  sideEffects: NoneOnDryRun
  timeoutSeconds: 5
