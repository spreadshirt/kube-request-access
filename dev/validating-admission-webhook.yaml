apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: kube-request-access-webhook
webhooks:
- name: kube-request-access.default.svc
  rules:
  - apiGroups:   [""]
    apiVersions: ["v1"]
    resources:   ["pods/exec"]
    operations: ["*"]
    scope:       "Namespaced"
  - apiGroups: ["spreadgroup.com"]
    apiVersions: ["v1"]
    resources: ["accessrequests", "accessgrants"]
    operations: ["CREATE"]
    scope: Namespaced
  clientConfig:
    service:
      namespace: default
      name: kube-request-access
    # caBundle is set by `make local-config`, DO NOT change it manually.  (this contains the base64 encoded localhost cert)
    caBundle: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURlekNDQW1PZ0F3SUJBZ0lVUXZHMDk0ckRkRGNDL3FXVkRPTXlJRTg5UGhJd0RRWUpLb1pJaHZjTkFRRUwKQlFBd0tqRW9NQ1lHQTFVRUF3d2ZhM1ZpWlMxeVpYRjFaWE4wTFdGalkyVnpjeTVrWldaaGRXeDBMbk4yWXpBZQpGdzB5TWpFeE1qa3hOVEkyTUROYUZ3MHlNakV5TWpreE5USTJNRE5hTUNveEtEQW1CZ05WQkFNTUgydDFZbVV0CmNtVnhkV1Z6ZEMxaFkyTmxjM011WkdWbVlYVnNkQzV6ZG1Nd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUIKRHdBd2dnRUtBb0lCQVFDdnlSTm9LZGxkNjBLZDBjUFBvSkUvMVc5dmxtU1RRM0YwUWwwU2FTRG8zNlF5REM3OQo5NlNlZnpkUGhUOUk5VE81Mnl5bmpwaFl2Z1JRLytjV3duRTI5WFVlTHhEenZLLzJEbVlkSHFBcGhLSjUyakp2CnhtaHgxSnB5TFV4SCswNEtBUmRqdU9oTS8xTjNwaGRYNW13T21jZEkzVEtXdW5YOTBhc1JNeVQ2MFVtRnJoRFkKSG5CQ0JiZ1F3eThFbmVWZmFGRTRkM1NSeWZ5dGlnS1M1azRYN3BUZEV0eWg3b1Vka1lKWFFaczU1L3VWOC9VNgpmaGRWN2U2amVDdktGaU42WEFSZmw4ZTdOUE9uQW5lS3lKa3hQeXVRNktBeU5ET2N2Z1FmZzExOGZhQTZKaVZFCldpWDdqaUExS0tNUnFNOWxZeFYyN0dRL0d4UFpSZ2JnTmhYN0FnTUJBQUdqZ1pnd2daVXdVZ1lEVlIwUkJFc3cKU1lJZmEzVmlaUzF5WlhGMVpYTjBMV0ZqWTJWemN5NWtaV1poZFd4MExuTjJZNEliZDJWaWFHOXZheTFoZFdScApkR1Z5TG1SbFptRjFiSFF1YzNaamdnbHNiMk5oYkdodmMzUXdDd1lEVlIwUEJBUURBZ2VBTUJNR0ExVWRKUVFNCk1Bb0dDQ3NHQVFVRkJ3TUJNQjBHQTFVZERnUVdCQlEwSlUyUURJMkVvMEdxTnFaUU5Cc2IwTFcvOFRBTkJna3EKaGtpRzl3MEJBUXNGQUFPQ0FRRUFmTmUrc0IxWWVxU2VTbkdPVnplMHRjakVQeTcxMmtNenVYWmVVVS91RkRubwo0alJTSFJ0Q3U5a0ZKRmQzK3owYXFYSkIzS3hmQ3RIZzFLSUczazZzOTJTbm16eVVheGliaXRiTUVRTmQ0Z05RCnRQSHZkMmI1RW50S2g5UW1KWHJRc1FiMDkxRitWYWhRQ3BMSHc3RFRRT09rQ2g1eU5Tem1VOEI3dTVteUN2Y3kKd0tvb3NDa3FHVU9WUjF3NzZleGN3WnZBUjd4azZTNDRpZUFtL05maWNWTmI5MmE5dWRDQmhSM2dJNEZPRmRieQpUdlVLWUl3UzVXMVh0N3dkMEt5VlFNWlJZdUswZDBxQm5aRmdvK0o1UnhrQTlvNDZsaHlaZzcwWFROMXRWNDFrCkZZdk14Rm9Sb0lRQ0xIOGFzRzJKUjloNHNJSGtWZlZzYXJtOElrWWRSdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K"  # CA_BUNDLE
  admissionReviewVersions: ["v1"]
  sideEffects: NoneOnDryRun
  timeoutSeconds: 5
